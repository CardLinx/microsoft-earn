<!--
Copyright (c) Microsoft Corporation. All rights reserved. 
Licensed under the MIT license. See LICENSE.txt file in the project root for full license information.
-->
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Enroll in Earn by Microsoft</title>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    @System.Web.Optimization.Styles.Render("~/earn/styles/enrollBundle")
    <script type="text/javascript">
        var appInsights = window.appInsights || function (config) {
            function s(config) { t[config] = function () { var i = arguments; t.queue.push(function () { t[config].apply(t, i) }) } } var t = { config: config }, r = document, f = window, e = "script", o = r.createElement(e), i, u; for (o.src = config.url || "//az416426.vo.msecnd.net/scripts/a/ai.0.js", r.getElementsByTagName(e)[0].parentNode.appendChild(o), t.cookie = r.cookie, t.queue = [], i = ["Event", "Exception", "Metric", "PageView", "Trace"]; i.length;) s("track" + i.pop()); return config.disableExceptionTracking || (i = "onerror", s("_" + i), u = f[i], f[i] = function (config, r, f, e, o) { var s = u && u(config, r, f, e, o); return s !== !0 && t["_" + i](config, r, f, e, o), s }), t
        }({
            instrumentationKey: "b2769bec-64c9-4192-aa4c-29499969657d"
        });

        window.appInsights = appInsights;
        appInsights.trackPageView();
    </script>
    <script language="javascript" type="text/javascript" src="https://www.microsoft.com/click/services/rio.ashx?ootc=200821438"></script>
</head>
<body>
    <section id="nav">
        <div class="container">
            <div class="logo">
                <a href="/">
                    <img src="https://az414848.vo.msecnd.net/card-linked-assets/earn_logo_blue_gry-1.png" />
                </a>
            </div>
            <div class="right-nav">
                <div class="top-nav name"><p id="login">@ViewBag.ProfileName @Html.Raw(ViewBag.SignOutHtmlLink)</p></div>
                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
    </section>

    <section id="settings" class="accounts-container">
        <div class="container">
            <div class="enroll-container">
                <h1>Hi @ViewBag.ProfileName,</h1>
                <p>Please fill out the form below to enroll your credit and debit cards. It's totally free to enroll.</p>
                <br />
                <p>And for a limited time, receive <strong>$5 in bonus Earn Credits</strong> after your first Earn transaction!</p>

                <div class="steps">
                    <div class="step first" data-bind="css: { 'current-step'  : currentStep() == 'step1'  }">
                        <h4>Step 1</h4>
                        <p>Contact Info</p>
                    </div>
                    <div class="step" data-bind="css: { 'current-step'  : currentStep() == 'step2'  }">
                        <h4>Step 2</h4>
                        <p>Add cards</p>
                    </div>
                    <div class="step" data-bind="css: { 'current-step'  : currentStep() == 'step3'  }">
                        <h4>Step 3</h4>
                        <p>Share</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="box" data-bind="visible: currentStep() == 'step1'">
                    <br />
                    <p class="description">Your email address (required)</p>
                    <p class="option-text">(We'll send Earn transaction confirmations and the Earn newsletter here.<sup>1</sup>)</p>
                    <input type="text" data-bind="value: settingsView.contactView.email" />
                    <br />
                    <br />
                    <p class="description">Your cell phone number (optional)</p>
                    <p class="option-text">(We'll text Earn transaction confirmations here.)</p>
                    <input type="text" data-bind="value: settingsView.contactView.phone" />
                    <br />
                    <br />
                    <p class="fineprint">
                        <input type="checkbox" data-bind="checked: selectedEnrollTerms" />
                        I accept the <a href="/legal/termsofuse" target="_blank">Terms of Use</a> and direct Microsoft,
                        <a href="/legal/termsofuse/#paymentprocessors" target="_blank">payment processors</a>, and participating merchants to
                        monitor and share credit and debit card transaction data about my purchases and offer redemptions to enable my participation in
                        <a href="http://earn.microsoft.com" target="_blank">Earn</a> and for such other uses of
                        my information as specifically set forth in the Terms of Use.
                    </p>
                    <p class="error" data-bind="text: enrollError"></p>
                    <a class="button" data-bind="click: enrollClicked">Next</a>
                    <p class="fineprint">
                        <sup>1</sup> You can unsubscribe from the newsletter at any time from the unsubscribe link within the newsletter.
                    </p>
                </div>


                <div class="box" data-bind="visible: currentStep() == 'step2'">
                    <h2 data-bind="visible:settingsView.registeredCardsView.hasAtLeastOneRegisteredCard ">Enrolled Cards</h2>
                    <table data-bind="with: settingsView.registeredCardsView">
                        <tbody data-bind="foreach: registeredCards">
                            <tr>
                                <td><p data-bind="text: formattedCardNumber()"></p></td>
                                <td><a data-bind="click: function() { $parent.deleteCard($data); }" class="button delete">Delete</a></td>
                            </tr>
                        </tbody>
                    </table>

                    <p data-bind="visible: settingsView.registeredCardsView.hasAtLeastOneRegisteredCard() && !settingsView.showAddCardIframe(), click: settingsView.addCardClicked" class="button addanothercard">
                        <span class="icon-plus"></span>Add another card
                    </p>

                    <h2 data-bind="visible:settingsView.showAddCardIframe">Add a Card</h2>
                    <p class="fineprint" data-bind="visible:settingsView.showAddCardIframe">
                        Your card will not be charged. There are no
                        costs or fees for enrolling in Earn. We only see card transactions at participating merchants, and we only use
                        your transaction information for the Earn program.
                    </p>
                    <p class="error" data-bind="text: settingsView.registeredCardsView.errorMessageDeletingCard"></p>
                    <div id="add-card-iframe" data-bind="visible: settingsView.showAddCardIframe">
                        <iframe frameborder="0" data-bind="attr: { src : settingsView.addCardFrameUrl  }"></iframe>
                    </div>
                    <a class="button" data-bind="visible: settingsView.registeredCardsView.hasAtLeastOneRegisteredCard, click: goToStep3Clicked">Next</a>
                </div>

                <div class="box step3" data-bind="visible: currentStep() == 'step3'">
                    <br />
                    <h2>Share with friends for bonus Earn Credits!</h2>
                    <p class="share">
                        Get <strong>$5 in bonus Earn Credits</strong> for each friend that enrolls using your personal link and makes their first Earn transaction. And they'll get <strong>$5 in bonus Earn Credits</strong> too!
                        <br />
                        Share now!
                    </p>

                    <div class="personal-link">
                        <p>Your personal link:</p>
                        <input type="text" data-bind="value: referralCodeView.shareUrl" disabled placeholder="Please wait..." />
                        <img src="Offers/Earn/content/images/spinner.gif" data-bind="visible: !referralCodeView.loaded()" class="spinner"/>
                    </div>
                    <div class="social-plugin">
                        <ul class="social">
                            <li>
                                <a class="facebook icon-facebook" data-bind="click: socialView.facebookPageShare">
                                    <img src="Offers/Earn/content/images/fb_40x40.png" />
                                </a>
                            </li>
                            <li>
                                <a class="twitter icon-twitter" data-bind="click: socialView.twitterPageShare">
                                    <img src="Offers/Earn/content/images/tw_40x40.png" />
                                </a>
                            </li>
                            <li>
                                <a class="email icon-email" data-bind="click: socialView.emailShare">
                                    <img src="Offers/Earn/content/images/email_40x40.png" />
                                </a>
                            </li>
                        </ul>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    @Html.Partial("~/offers/earn/views/common/socialbar.cshtml")
    @Html.Partial("~/offers/earn/views/common/footer.cshtml")
    <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.3.min.js"></script>
    <script src="//ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.8.3.js"></script>

    <script>
        $(document).ready(function () {
            var $elem = $('#idPPScarab');
            var $img = $elem.find('img');

            var signedIn = $img.hasClass('PassportSignOut');
            var signedOut = $img.hasClass('PassportSignIn');
            var text = '';
            if (signedIn) {
                text = 'Sign Out';
            }

            var liveMobileQueryString = $(window).width() < 710 ? '&pcexp=false' : '';
            if (signedOut) {
                text = 'Sign In';
                $('#signinbutton').attr('href', $elem.attr('href') + liveMobileQueryString);
                $elem.attr('href', $elem.attr('href') + liveMobileQueryString);
            }

            $elem.html(text);
            $('#login').show();
        });
    </script>

    <script src="//ajax.aspnetcdn.com/ajax/knockout/knockout-3.3.0.js"></script>
    @System.Web.Optimization.Scripts.Render("~/earn/scripts/accountsscriptBundle")
    <script>
        $(document).ready(function () {
            helper.setupAuth();
            var pageViewModel = new window.enrollViewModel({}, '@ViewBag.CurrentStep', '@ViewBag.UserId');
            ko.applyBindings(pageViewModel);
        });
    </script>
</body>
</html>